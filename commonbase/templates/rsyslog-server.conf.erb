##################################################################
#### ATTENTION: This file is managed by CHEF and any manual changes
#### WILL BE OVERWRITTEN when chef-client runs next
######################################################################

#### RSYSLOG-SERVER NOTES ####

# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html
# If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html

# type (facility).priority (severity)  destination(where to send the log)

# The facility or type data is represented by the internal system processes that generates the messages. In Linux internal processes (facilities) that generate logs are standardized as follows:
    #auth = messages generated by authentication processes (login).
    #cron= messages generated by scheduled processes (crontab).
    #daemon = messages generated by daemons (internal services).
    #kernel = messages generated by the Linux Kernel itself.
    #mail = messages generated by a mail server.
    #syslog = messages generated by the rsyslog daemon itself.
    #lpr = messages generated by local printers or a print server.
    #local0 – local7 = custom messages defined by an administrator (local7 is usually assigned for Cisco or Windows).

# The priority (severity) levels are standardized also. Each priority is assigned with a standard abbreviation and a number as described below. The 7th priority is the higher level of all.

    #emerg = Emergency – 0
    #alert = Alerts – 1
    #err = Errors – 3
    #warn = Warnings – 4
    #notice = Notification – 5
    #info = Information – 6
    #debug = Debugging – 7

# Special Rsyslog keywords:

    #* = all facilities or priorities
    #none = the facilities have no given priorities Eg: mail.none

#### MODULES ####

$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)
$ModLoad imjournal # provides access to the systemd journal
$ModLoad imudp
$UDPServerRun 514

#### TEMPLATE ####
$template RemoteLogs, "/var/rsyslog/RemoteLogs/%HOSTNAME%/%PROGRAMNAME%.log"
#. ?RemoteLogs & ~

#### GLOBAL DIRECTIVES ####

$WorkDirectory /var/lib/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
$IncludeConfig /etc/rsyslog.d/*.conf
$OmitLocalLogging on
$IMJournalStateFile imjournal.state

#### TLS CONFIG ####

$DefaultNetstreamDriverCAFile /etc/pki/rsyslog/ca-cert.pem
$DefaultNetstreamDriver gtls
$ActionSendStreamDriverMode 1
$ActionSendStreamDriverAuthMode anon

#### CUSTOM RULES ####
:msg,regex, ".*Error.*Data Collector.*Chef Automate" ~

#### DEFAULT RULES ####
authpriv.*,*.info,mail.none,authpriv.none,cron.none   	?RemoteLogs